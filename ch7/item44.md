# Item 44
## 표준 함수형 인터페이스를 사용하라

- 자바가 람다를 지원하면서 API를 작성하는 모범사례가 크게 바뀌었다
  - 상위 클래스의 기본 메서드를 재정의해 원하는 동작을 구현하는 템플릿 메서드 사용이 크게 줄었다
  - 현대적인 해법은 같은 효과의 함수 객체를 받는 정적 팩터리나 생성자를 제공하는 것
  - 함수 객체를 매개변수로 받는 생성자와 메서드를 더 많이 만들어야 한다
 
#### LinkedHashMap 예시
```java
// LinkedHashMap의 내부 구현 메서드인 removeEldestEnrty를 재정의하여
// 원소가 100개가 넘어가면 가장 오래된 원소를 제거하게 사용 
protected boolean removeEldestEntry(Map.Entry<K,V> eldest) {
    return size() > 100;
}
```
위의 코드를 람다를 사용해 함수형 인터페이스를 만든다면 아래와 같다


```java
@FunctionalInterface
interface EldestEntryRemovalFunction<K, V> {
  boolean remove(Map<K, V> map, Map.Entry<K, V> eldest);
}
// 이러한 인터페이스도 잘 동작하긴하나, 굳이 이렇게 사용할 이유가 없다.
// java 표준 라이브러리에 이미 같은 모양의 인터페이스가 준비되어있기 때문
// 위의 직접 만든 EldestEntryRemovalFunction 대신 표준 인터페이스인
// BiPredicate<Map<K, V>, Map.Entry<K, V> 를 사용할 수 있다.
```

### java.util.function 패키지의 기본 인터페이스 6가지
이 패키지에는 총 43개의 인터페이스가 있지만, 기본적인 인터페이스 6가지를 소개한다.
6개의 기본 인터페이스를 기억하면 나머지를 유추 가능하다
1. UnaryOperator | T apply(T t) : 반환값과 인수의 타입이 같은 함수(인수가 1개)
2. BinaryOperator | T apply(T t1, T t2) : 반환값과 인수의 타입이 같은 함수(인수가 2개)
3. Predicate | boolean testS(T t) : 인수 하나를 받아 boolean을 반환하는 함수
4. Function<T, R> | R apply(T t) : 인수와 반환 타입이 다른 함수
5. Supplier | T get() : 인수를 받지 않고 값을 반환/제공하는 함수
6. Consumer | void accept(T t) : 인수를 하나 받고 반환값은 없는 함수

### 직접 함수형 인터페이스를 작성해야 할때는?
표준 함수형 인터페이스가 있더라도 용도에 맞는게 없다면 직접 작성해야할 때가 있다
예를들어 Comparator 인터페이스는 구조적으로는 ToIntBiFunction<T,U> 인터페이스와 같지만
직접 작성한 예이다.
- 직접 작성해야하는 것을 고민해보아야 하는 상황
  - 자주 쓰이며, 이름 자체가 용도를 명확히 설명해준다 (Comparator 이름이 보다 용도를 정확히 설명한다)
  - 반드시 따라야 하는 규칙이 있다. (Compare()는 따라야하는 규약이 많다)
  - 유용한 디폴트 메서드를 제공할 수 있다. (Comparator는 다양한 메서드를 제공한다)

#### @Functionallnterface
직접 작성할 때에는 위의 에너테이션을 꼭 붙여주어야 한다.
이는 @Override를 붙여주는 것과 같은 이유이다
- 해당 클래스의 코드나 설명 문서를 읽을 때 람다용으로 설계된 것임을 알려주기 위해
- 해당 인터페이스가 추상 메서드를 오직 하나만 가지고 있어야 컴파일할 수 있도록 하기 위해
- 유지보수 과정에서 누군가 실수로 메서드를 추가하지 못하게 막기 위해

### 함수형 인터페이스를 API에서 사용할 때 주의사항
- 서로 다른 함수형 인터페이스를 같은 위치의 인수로 받는 메서드를 다중 정의해서는 안된다
- 이러한 상황은 모호함을 불러일으키기 때문에 피하는 것이 좋다


```
# 핵심!

 자바 8부터는 자바도 람다를 지원하기 때문에 API를 설계할 때 람다도 염두에 두어야한다.
입력값과 반환값에 함수형 인터페이스 타입을 활용해보자. 보통은 java.util.function 패키지의
표준 함수형 인터페이스를 사용하는 것이 가장 좋은 선택이다. 흔하지는 않지만 직접 새로운 함수형
인터페이스를 만들어 쓰는 편이 나을 수도 있다.
```
